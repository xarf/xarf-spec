{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://xarf.org/schemas/v4/content-class.json",
  "title": "XARF v4 Content Class Schema",
  "description": "Schema for malicious web content including phishing, malware hosting, fraud, and harmful online content",
  "allOf": [
    {
      "$ref": "xarf-core.json"
    },
    {
      "type": "object",
      "properties": {
        "class": {
          "const": "content"
        },
        "type": {
          "type": "string",
          "enum": [
            "phishing",
            "malware",
            "fraud",
            "spamvertised",
            "csam",
            "defacement",
            "illegal_advertisement",
            "web_hack",
            "exploit",
            "violence",
            "harassment",
            "doxing",
            "scam",
            "fake_shop"
          ],
          "description": "Specific type of malicious content"
        },
        "evidence_source": {
          "type": "string",
          "enum": [
            "crawler",
            "user_report",
            "automated_scan", 
            "spam_analysis",
            "security_research",
            "takedown_request",
            "manual_analysis"
          ],
          "description": "Source of evidence for content abuse"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "URL of the malicious content (REQUIRED)",
          "examples": [
            "http://phishing.example.com/login.html",
            "https://malware-host.org/download/virus.exe"
          ]
        },
        "domain": {
          "type": "string",
          "format": "hostname",
          "description": "Domain hosting the malicious content",
          "examples": ["phishing.example.com", "malware-host.org"]
        },
        "ip_address": {
          "type": "string",
          "anyOf": [
            {"format": "ipv4"},
            {"format": "ipv6"}
          ],
          "description": "IP address hosting the content",
          "examples": ["192.0.2.100", "2001:db8::200"]
        },
        "target_brand": {
          "type": "string",
          "maxLength": 200,
          "description": "Brand, organization, or service being impersonated (for phishing)",
          "examples": ["PayPal", "Amazon", "Microsoft", "Bank of America", "Netflix"]
        },
        "target_category": {
          "type": "string",
          "enum": [
            "financial",
            "e-commerce",
            "social_media",
            "cloud_services",
            "email_services",
            "government",
            "healthcare",
            "education",
            "cryptocurrency",
            "gaming",
            "other"
          ],
          "description": "Category of service being targeted"
        },
        "file_hash": {
          "type": "string",
          "pattern": "^(md5|sha1|sha256|sha512):[a-fA-F0-9]+$",
          "description": "Hash of malicious file in format 'algorithm:hexvalue'",
          "examples": [
            "sha256:deadbeefcafebabe1234567890abcdef1234567890abcdef1234567890abcdef",
            "md5:5d41402abc4b2a76b9719d911017c592"
          ]
        },
        "file_size": {
          "type": "integer",
          "minimum": 0,
          "description": "Size of malicious file in bytes"
        },
        "file_type": {
          "type": "string",
          "maxLength": 100,
          "description": "Type or format of malicious file",
          "examples": [
            "executable", "pdf", "document", "archive", "script",
            "image", "video", "android_apk", "browser_extension"
          ]
        },
        "malware_family": {
          "type": "string",
          "maxLength": 200,
          "description": "Malware family name or classification",
          "examples": [
            "Trojan.Win32.Generic",
            "Backdoor.Linux.Mirai", 
            "Ransomware.CryptoLocker",
            "Adware.Browser.Helper"
          ]
        },
        "detection_names": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 200
          },
          "description": "Malware detection names from various security vendors",
          "examples": [
            ["Trojan:Win32/Wacatac.B!ml", "Gen:Heur.Trojan.Script.1"]
          ],
          "maxItems": 50
        },
        "page_title": {
          "type": "string",
          "maxLength": 500,
          "description": "Title of the malicious webpage",
          "examples": [
            "Secure Login - PayPal",
            "Account Verification Required",
            "Free Download"
          ]
        },
        "page_language": {
          "type": "string",
          "pattern": "^[a-z]{2}(-[A-Z]{2})?$",
          "description": "Primary language of the webpage content",
          "examples": ["en", "es", "fr", "de", "ru", "zh", "ja"]
        },
        "hosting_provider": {
          "type": "string",
          "maxLength": 200,
          "description": "Hosting provider or cloud service",
          "examples": ["AWS", "CloudFlare", "DigitalOcean", "Shared hosting provider"]
        },
        "registration_date": {
          "type": "string",
          "format": "date-time",
          "description": "Domain registration date (for newly registered domains)"
        },
        "first_seen": {
          "type": "string",
          "format": "date-time",
          "description": "When this malicious content was first observed"
        },
        "last_seen": {
          "type": "string", 
          "format": "date-time",
          "description": "When this malicious content was last observed"
        },
        "takedown_requested": {
          "type": "boolean",
          "description": "Whether takedown has been requested"
        },
        "takedown_status": {
          "type": "string",
          "enum": ["requested", "in_progress", "completed", "denied", "offline"],
          "description": "Status of content takedown efforts"
        },
        "social_engineering": {
          "type": "object",
          "properties": {
            "urgency_language": {
              "type": "boolean",
              "description": "Uses urgent language to pressure victims"
            },
            "authority_impersonation": {
              "type": "boolean", 
              "description": "Impersonates authority figures or trusted entities"
            },
            "fear_tactics": {
              "type": "boolean",
              "description": "Uses fear or intimidation tactics"
            },
            "reward_promises": {
              "type": "boolean",
              "description": "Promises rewards or benefits"
            },
            "time_pressure": {
              "type": "boolean",
              "description": "Creates artificial time pressure"
            }
          },
          "description": "Social engineering techniques used",
          "additionalProperties": false
        },
        "technical_indicators": {
          "type": "object",
          "properties": {
            "suspicious_redirects": {
              "type": "boolean",
              "description": "Uses suspicious redirects or URL shorteners"
            },
            "javascript_obfuscation": {
              "type": "boolean",
              "description": "Uses obfuscated JavaScript code"
            },
            "form_harvesting": {
              "type": "boolean",
              "description": "Contains forms designed to harvest user data"
            },
            "lookalike_domain": {
              "type": "boolean",
              "description": "Domain resembles legitimate organization"
            },
            "typosquatting": {
              "type": "boolean",
              "description": "Domain is a typosquatted version of legitimate site"
            },
            "https_abuse": {
              "type": "boolean",
              "description": "Misuses HTTPS certificates for legitimacy"
            }
          },
          "description": "Technical indicators of malicious content",
          "additionalProperties": false
        },
        "content_analysis": {
          "type": "object",
          "properties": {
            "similarity_score": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Visual similarity to legitimate target site"
            },
            "logo_theft": {
              "type": "boolean",
              "description": "Uses stolen logos or branding"
            },
            "template_reuse": {
              "type": "boolean",
              "description": "Reuses phishing kit or template"
            },
            "credential_fields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Types of credentials being harvested",
              "examples": [["username", "password", "ssn", "credit_card"]]
            }
          },
          "description": "Analysis of content characteristics",
          "additionalProperties": false
        }
      },
      "required": ["url"]
    }
  ],
  "examples": [
    {
      "xarf_version": "4.0.0",
      "report_id": "h8i9j0k1-l2m3-4567-hi89-01234gh56789",
      "timestamp": "2024-01-15T13:45:30Z",
      "reporter": {
        "org": "PhishTank",
        "contact": "admin@phishtank.com",
        "type": "automated"
      },
      "source_identifier": "192.0.2.75",
      "class": "content",
      "type": "phishing",
      "url": "http://fake-bank.example.com/login.php",
      "target_brand": "Example Bank",
      "target_category": "financial",
      "evidence_source": "crawler",
      "evidence": [
        {
          "content_type": "image/png",
          "description": "Screenshot of phishing page",
          "payload": "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg=="
        }
      ],
      "tags": ["phishing:banking", "target:example_bank"],
      "confidence": 0.98
    },
    {
      "xarf_version": "4.0.0",
      "report_id": "m9n0p1q2-r3s4-5678-mn90-12345op67890",
      "timestamp": "2024-01-15T11:22:15Z",
      "reporter": {
        "org": "Malware Research Lab",
        "contact": "malware@security-research.org",
        "type": "automated"
      },
      "source_identifier": "203.0.113.50",
      "class": "content",
      "type": "malware",
      "url": "http://download-center.example.com/setup.exe",
      "file_hash": "sha256:deadbeefcafebabe1234567890abcdef1234567890abcdef1234567890abcdef",
      "file_size": 2048576,
      "malware_family": "Trojan.Win32.Generic",
      "detection_names": ["Trojan:Win32/Wacatac.B!ml", "Gen:Heur.Trojan.Script.1"],
      "evidence_source": "automated_scan",
      "tags": ["malware:trojan", "platform:windows", "delivery:direct_download"]
    }
  ]
}