{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://xarf.org/schemas/v4/types/infrastructure-botnet.json",
	"title": "XARF v4 Infrastructure - Botnet Type Schema",
	"description": "Schema for Botnet infections and compromised systems",
	"allOf": [
		{
			"$ref": "../xarf-core.json"
		},
		{
			"type": "object",
			"properties": {
				"category": {
					"const": "infrastructure"
				},
				"type": {
					"const": "botnet"
				},
				"malware_family": {
					"type": "string",
					"maxLength": 200,
					"description": "Malware family classification (optional metadata)",
					"examples": [
						"conficker",
						"mirai",
						"emotet",
						"zeus"
					]
				},
				"c2_server": {
					"type": "string",
					"description": "Command and control server domain or IP",
					"examples": [
						"evil-c2.example.com",
						"192.0.2.100"
					]
				},
				"c2_protocol": {
					"type": "string",
					"enum": [
						"http",
						"https",
						"tcp",
						"udp",
						"dns",
						"irc",
						"p2p",
						"custom"
					],
					"description": "Protocol used for C2 communications"
				},
				"bot_capabilities": {
					"type": "array",
					"items": {
						"type": "string",
						"enum": [
							"ddos",
							"spam",
							"proxy",
							"keylogger",
							"file_download",
							"remote_shell",
							"cryptocurrency_mining",
							"data_theft"
						]
					},
					"description": "Capabilities observed in the bot"
				},
				"compromise_evidence": {
					"type": "string",
					"description": "Evidence of how compromise was detected (REQUIRED)",
					"examples": [
						"C2 communication observed",
						"Malicious process running",
						"Suspicious network traffic patterns"
					]
				},
				"first_seen": {
					"type": "string",
					"format": "date-time",
					"description": "When the botnet activity was first observed",
					"examples": [
						"2024-01-14T18:45:00Z"
					]
				},
				"last_seen": {
					"type": "string",
					"format": "date-time",
					"description": "When the botnet activity was last observed",
					"examples": [
						"2025-01-11T12:16:22Z"
					]
				},
				"infection_vector": {
					"type": "string",
					"enum": [
						"network_worm",
						"email_attachment",
						"drive_by_download",
						"exploit_kit",
						"social_engineering",
						"malicious_link",
						"usb_propagation",
						"brute_force"
					],
					"description": "How the system was initially infected"
				}
			},
			"required": [
				"compromise_evidence"
			]
		}
	]
}
