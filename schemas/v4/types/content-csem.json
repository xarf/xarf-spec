{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://xarf.org/schemas/v4/types/content-csem.json",
	"title": "XARF v4 Content - CSEM Type Schema",
	"description": "Schema for Child Sexual Exploitation Material (grooming, solicitation, and other exploitation activities)",
	"allOf": [
		{
			"$ref": "./content-base.json"
		},
		{
			"type": "object",
			"properties": {
				"type": {
					"const": "csem"
				},
				"exploitation_type": {
					"type": "string",
					"enum": [
						"grooming",
						"solicitation",
						"sextortion",
						"trafficking",
						"distribution",
						"production",
						"possession"
					],
					"description": "REQUIRED: Type of exploitation activity"
				},
				"victim_age_range": {
					"type": "string",
					"enum": [
						"infant",
						"toddler",
						"prepubescent",
						"pubescent",
						"unknown"
					],
					"x-recommended": true,
					"description": "RECOMMENDED: Estimated age range of victim"
				},
				"platform": {
					"type": "string",
					"enum": [
						"social_media",
						"messaging_app",
						"gaming_platform",
						"forum",
						"email",
						"darkweb",
						"other"
					],
					"x-recommended": true,
					"description": "RECOMMENDED: Platform where exploitation occurred"
				},
				"detection_method": {
					"type": "string",
					"enum": [
						"behavioral_analysis",
						"keyword_detection",
						"user_report",
						"ai_detection",
						"manual_review",
						"law_enforcement_referral"
					],
					"description": "REQUIRED: Method used to detect the exploitation"
				},
				"evidence_type": {
					"type": "array",
					"items": {
						"type": "string",
						"enum": [
							"chat_logs",
							"images",
							"videos",
							"user_profile",
							"metadata"
						]
					},
					"x-recommended": true,
					"description": "RECOMMENDED: Types of evidence collected"
				},
				"perpetrator_indicators": {
					"type": "object",
					"properties": {
						"account_id": {
							"type": "string",
							"description": "OPTIONAL: Account identifier of perpetrator"
						},
						"ip_addresses": {
							"type": "array",
							"items": {
								"type": "string",
								"format": "ipv4"
							},
							"description": "OPTIONAL: IP addresses associated with perpetrator"
						},
						"pattern_of_behavior": {
							"type": "string",
							"description": "OPTIONAL: Description of behavioral patterns"
						}
					},
					"description": "OPTIONAL: Indicators associated with the perpetrator"
				},
				"reporting_obligations": {
					"type": "array",
					"items": {
						"type": "string",
						"enum": [
							"NCMEC",
							"IWF",
							"local_law_enforcement",
							"europol",
							"interpol",
							"platform_safety_team",
							"other"
						]
					},
					"x-recommended": true,
					"description": "RECOMMENDED: Entities to which this has been or should be reported"
				}
			},
			"required": [
				"exploitation_type",
				"detection_method"
			]
		}
	],
	"examples": [
		{
			"xarf_version": "4.0.0",
			"report_id": "csem-2025-grooming-001",
			"timestamp": "2025-01-20T14:20:00Z",
			"reporter": {
				"org": "Platform Safety Team",
				"contact": "safety@platform.example",
				"type": "manual"
			},
			"source_identifier": "203.0.113.55",
			"category": "content",
			"type": "csem",
			"url": "https://platform.example/user/suspicious-account",
			"exploitation_type": "grooming",
			"victim_age_range": "pubescent",
			"detection_method": "behavioral_analysis",
			"platform": "social_media",
			"evidence_type": [
				"chat_logs",
				"user_profile"
			],
			"reporting_obligations": [
				"NCMEC",
				"local_law_enforcement",
				"platform_safety_team"
			],
			"perpetrator_indicators": {
				"account_id": "user123456",
				"ip_addresses": [
					"203.0.113.55",
					"203.0.113.56"
				],
				"pattern_of_behavior": "Repeated contact with minors, requesting private information"
			}
		}
	]
}
