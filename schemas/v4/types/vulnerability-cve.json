{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://xarf.org/schemas/v4/types/vulnerability-cve.json",
	"title": "XARF v4 Vulnerability - CVE Type Schema",
	"description": "Schema for Common Vulnerabilities and Exposures (CVE) reports",
	"allOf": [
		{
			"$ref": "../xarf-core.json"
		},
		{
			"type": "object",
			"properties": {
				"class": {
					"const": "vulnerability"
				},
				"type": {
					"const": "cve"
				},
				"evidence_source": {
					"type": "string",
					"enum": [
						"vulnerability_scan",
						"researcher_analysis",
						"automated_discovery",
						"penetration_testing"
					],
					"description": "Source of CVE vulnerability evidence"
				},
				"service": {
					"type": "string",
					"maxLength": 200,
					"description": "Vulnerable service or application name (REQUIRED)",
					"examples": [
						"Apache HTTP Server",
						"OpenSSL",
						"Windows SMB",
						"SSH Server",
						"MySQL Database"
					]
				},
				"service_version": {
					"type": "string",
					"maxLength": 100,
					"description": "Version of the vulnerable service",
					"examples": [
						"2.4.41",
						"1.1.1a",
						"OpenSSH_7.4",
						"5.7.33"
					]
				},
				"service_port": {
					"type": "integer",
					"minimum": 1,
					"maximum": 65535,
					"description": "Port number where vulnerable service is running",
					"examples": [
						80,
						443,
						22,
						3389,
						21,
						23,
						25
					]
				},
				"cve_id": {
					"type": "string",
					"pattern": "^CVE-[0-9]{4}-[0-9]+$",
					"description": "CVE identifier (REQUIRED for CVE type)",
					"examples": [
						"CVE-2021-44228",
						"CVE-2014-0160",
						"CVE-2017-5638"
					]
				},
				"cve_ids": {
					"type": "array",
					"items": {
						"type": "string",
						"pattern": "^CVE-[0-9]{4}-[0-9]+$"
					},
					"description": "Multiple CVE identifiers if vulnerability involves multiple CVEs",
					"maxItems": 10,
					"uniqueItems": true
				},
				"cvss_score": {
					"type": "number",
					"minimum": 0.0,
					"maximum": 10.0,
					"description": "CVSS vulnerability score (0.0-10.0)"
				},
				"cvss_vector": {
					"type": "string",
					"pattern": "^CVSS:3\\\\.[01]/.*",
					"description": "CVSS v3 vector string",
					"examples": [
						"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
						"CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
					]
				},
				"cvss_version": {
					"type": "string",
					"enum": [
						"2.0",
						"3.0",
						"3.1"
					],
					"description": "CVSS version used for scoring"
				},
				"risk_level": {
					"type": "string",
					"enum": [
						"info",
						"low",
						"medium",
						"high",
						"critical"
					],
					"description": "Risk assessment level"
				},
				"severity": {
					"type": "string",
					"enum": [
						"informational",
						"low",
						"medium",
						"high",
						"critical"
					],
					"description": "Severity classification"
				},
				"exploitability": {
					"type": "string",
					"enum": [
						"theoretical",
						"poc_available",
						"functional",
						"weaponized"
					],
					"description": "Level of exploit availability and maturity"
				},
				"patch_available": {
					"type": "boolean",
					"description": "Whether a patch or fix is available"
				},
				"patch_version": {
					"type": "string",
					"maxLength": 100,
					"description": "Version that fixes the vulnerability",
					"examples": [
						"2.4.46",
						"1.1.1k",
						"OpenSSH_8.0",
						"5.7.35"
					]
				},
				"patch_url": {
					"type": "string",
					"format": "uri",
					"description": "URL to patch, security advisory, or fix information"
				},
				"vendor_advisory": {
					"type": "string",
					"format": "uri",
					"description": "URL to vendor security advisory"
				},
				"disclosure_date": {
					"type": "string",
					"format": "date-time",
					"description": "When CVE was publicly disclosed"
				},
				"impact_assessment": {
					"type": "object",
					"properties": {
						"confidentiality": {
							"type": "string",
							"enum": [
								"none",
								"low",
								"high"
							],
							"description": "Impact on data confidentiality"
						},
						"integrity": {
							"type": "string",
							"enum": [
								"none",
								"low",
								"high"
							],
							"description": "Impact on data integrity"
						},
						"availability": {
							"type": "string",
							"enum": [
								"none",
								"low",
								"high"
							],
							"description": "Impact on system availability"
						}
					},
					"description": "CIA triad impact assessment",
					"additionalProperties": false
				},
				"remediation_priority": {
					"type": "string",
					"enum": [
						"low",
						"medium",
						"high",
						"critical",
						"emergency"
					],
					"description": "Recommended priority for remediation"
				}
			},
			"required": [
				"service",
				"service_port",
				"cve_id"
			]
		}
	],
	"examples": [
		{
			"xarf_version": "4.0.0",
			"report_id": "cve-901b2345-c678-90d1-e234-567890123456",
			"timestamp": "2024-01-15T09:20:30Z",
			"reporter": {
				"org": "Vulnerability Scanner Service",
				"contact": "security@vulnscan.org",
				"type": "automated"
			},
			"source_identifier": "203.0.113.75",
			"class": "vulnerability",
			"type": "cve",
			"service": "Apache HTTP Server",
			"service_version": "2.4.41",
			"service_port": 80,
			"cve_id": "CVE-2021-41773",
			"cvss_score": 7.5,
			"cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
			"risk_level": "high",
			"severity": "high",
			"patch_available": true,
			"patch_version": "2.4.51",
			"evidence_source": "vulnerability_scan",
			"evidence": [
				{
					"content_type": "text/plain",
					"description": "Vulnerability scan results showing Apache version",
					"payload": "QXBhY2hlIEhUVFAgU2VydmVyIDIuNC40MSBkZXRlY3RlZCB3aXRoIENWRS0yMDIxLTQxNzcz"
				}
			],
			"tags": [
				"cve:CVE-2021-41773",
				"severity:high",
				"service:apache"
			]
		}
	]
}
