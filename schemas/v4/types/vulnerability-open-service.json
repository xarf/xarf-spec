{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://xarf.org/schemas/v4/types/vulnerability-open-service.json",
	"title": "XARF v4 Vulnerability - Open Service Type Schema",
	"description": "Schema for open services that should not be publicly accessible (DNS resolvers, NTP servers, memcached, SSDP) and can be exploited for DDoS amplification or other attacks",
	"allOf": [
		{
			"$ref": "../xarf-core.json"
		},
		{
			"type": "object",
			"properties": {
				"category": {
					"const": "vulnerability"
				},
				"type": {
					"const": "open_service"
				},
				"evidence_source": {
					"type": "string",
					"enum": [
						"vulnerability_scan",
						"automated_scan",
						"researcher_analysis",
						"network_monitoring",
						"security_audit"
					],
					"description": "Source of open service vulnerability evidence"
				},
				"service": {
					"type": "string",
					"maxLength": 200,
					"description": "Open service name (REQUIRED)",
					"examples": [
						"DNS Resolver",
						"NTP Server",
						"Memcached",
						"SSDP",
						"SMTP Relay"
					]
				},
				"service_port": {
					"type": "integer",
					"minimum": 1,
					"maximum": 65535,
					"description": "Port number where service is running",
					"examples": [
						53,
						123,
						11211,
						1900,
						25
					]
				}
			},
			"required": [
				"service"
			]
		}
	],
	"examples": [
		{
			"xarf_version": "4.0.0",
			"report_id": "550e8400-e29b-41d4-a716-446655440001",
			"timestamp": "2024-01-15T14:30:25Z",
			"reporter": {
				"org": "Security Research Lab",
				"contact": "security@seclab.org",
				"domain": "seclab.org"
			},
			"sender": {
				"org": "Security Research Lab",
				"contact": "security@seclab.org",
				"domain": "seclab.org"
			},
			"source_identifier": "192.0.2.45",
			"source_port": 53,
			"category": "vulnerability",
			"type": "open_service",
			"service": "DNS Resolver",
			"service_port": 53,
			"evidence_source": "automated_scan",
			"description": "Open DNS resolver that can be exploited for DDoS amplification attacks",
			"confidence": 0.95,
			"evidence": [
				{
					"content_type": "text/plain",
					"description": "DNS amplification test results",
					"payload": "T3BlbiBETlMgcmVzb2x2ZXIgcmVzcG9uZGluZyB0byByZWN1cnNpdmUgcXVlcmllcw=="
				}
			],
			"tags": [
				"service:dns",
				"vulnerability:open_resolver",
				"risk:amplification"
			]
		}
	]
}
