{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://xarf.org/schemas/v4/copyright-class.json",
  "title": "XARF v4 Copyright Class Schema",
  "description": "Schema for intellectual property infringement including copyright violations, trademark abuse, and DMCA-related reports",
  "allOf": [
    {
      "$ref": "xarf-core.json"
    },
    {
      "type": "object",
      "properties": {
        "class": {
          "const": "copyright"
        },
        "type": {
          "type": "string",
          "enum": ["copyright", "trademark"],
          "description": "Type of intellectual property violation"
        },
        "evidence_source": {
          "type": "string",
          "enum": [
            "automated_scan",
            "rights_holder_report",
            "crawler",
            "user_report",
            "dmca_notice",
            "legal_notice"
          ],
          "description": "Source of evidence for copyright infringement"
        },
        "work_title": {
          "type": "string",
          "maxLength": 500,
          "description": "Title of the copyrighted work being infringed (REQUIRED)",
          "examples": [
            "Avengers: Endgame",
            "Microsoft Office 2021",
            "Adobe Photoshop CC",
            "Game of Thrones Season 8"
          ]
        },
        "work_type": {
          "type": "string",
          "enum": [
            "movie",
            "tv_series",
            "music",
            "software",
            "game",
            "book",
            "image",
            "document",
            "artwork",
            "video",
            "other"
          ],
          "description": "Type of copyrighted work"
        },
        "work_identifier": {
          "type": "string",
          "maxLength": 200,
          "description": "External identifier for the work (IMDB, ISBN, etc.)",
          "examples": [
            "tt4154796",
            "ISBN-978-0123456789",
            "ISRC-USRC17607839"
          ]
        },
        "rights_holder": {
          "type": "string",
          "maxLength": 300,
          "description": "Copyright or trademark holder (REQUIRED)",
          "examples": [
            "Disney Enterprises, Inc.",
            "Microsoft Corporation",
            "Adobe Inc.",
            "HBO Entertainment"
          ]
        },
        "rights_holder_contact": {
          "type": "string",
          "format": "email",
          "description": "Contact email for the rights holder",
          "examples": ["legal@disney.com", "dmca@microsoft.com"]
        },
        "authorized_representative": {
          "type": "string",
          "maxLength": 200,
          "description": "Name of authorized representative submitting report",
          "examples": ["Legal Department", "John Smith, Legal Counsel"]
        },
        "infringing_url": {
          "type": "string",
          "format": "uri",
          "description": "URL where infringing content is hosted",
          "examples": [
            "http://piracy-site.example.com/movies/avengers.mp4",
            "https://warez.example.org/software/photoshop.zip"
          ]
        },
        "infringing_description": {
          "type": "string",
          "maxLength": 1000,
          "description": "Description of how the content infringes on copyrights"
        },
        "torrent_hash": {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{40}$",
          "description": "BitTorrent info hash for P2P sharing (SHA-1 hash)",
          "examples": ["aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d"]
        },
        "magnet_link": {
          "type": "string",
          "pattern": "^magnet:",
          "description": "Magnet link for P2P sharing",
          "examples": ["magnet:?xt=urn:btih:aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d"]
        },
        "swarm_size": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of peers in the torrent swarm"
        },
        "seeders": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of seeders in the torrent swarm"
        },
        "leechers": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of leechers in the torrent swarm"
        },
        "file_list": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 500
          },
          "description": "List of infringing files in the torrent or download",
          "examples": [
            ["Avengers.Endgame.2019.1080p.BluRay.x264.mkv", "subtitles.srt"]
          ],
          "maxItems": 100
        },
        "file_sizes": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 0
          },
          "description": "File sizes in bytes corresponding to file_list",
          "maxItems": 100
        },
        "total_size_bytes": {
          "type": "integer",
          "minimum": 0,
          "description": "Total size of all infringing files in bytes"
        },
        "tracker_urls": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "description": "BitTorrent tracker URLs associated with the infringement",
          "examples": [
            ["udp://tracker.example.com:1337", "http://tracker2.example.org:8080"]
          ],
          "maxItems": 50
        },
        "dht_nodes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "DHT nodes associated with P2P sharing",
          "maxItems": 20
        },
        "download_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of times content has been downloaded"
        },
        "upload_date": {
          "type": "string",
          "format": "date-time",
          "description": "When infringing content was first uploaded"
        },
        "detection_date": {
          "type": "string",
          "format": "date-time",
          "description": "When infringement was first detected"
        },
        "dmca_notice": {
          "type": "object",
          "properties": {
            "notice_id": {
              "type": "string",
              "maxLength": 100,
              "description": "Unique identifier for the DMCA notice"
            },
            "submitter_name": {
              "type": "string",
              "maxLength": 200,
              "description": "Name of person submitting DMCA notice"
            },
            "submitter_email": {
              "type": "string",
              "format": "email",
              "description": "Email of DMCA notice submitter"
            },
            "submitter_address": {
              "type": "string",
              "maxLength": 500,
              "description": "Physical address of DMCA notice submitter"
            },
            "good_faith_statement": {
              "type": "boolean",
              "description": "Attestation of good faith belief in infringement"
            },
            "accuracy_statement": {
              "type": "boolean", 
              "description": "Statement of accuracy under penalty of perjury"
            },
            "authorization_statement": {
              "type": "boolean",
              "description": "Statement of authorization to act on behalf of rights holder"
            }
          },
          "description": "DMCA takedown notice details",
          "additionalProperties": false
        },
        "takedown_request": {
          "type": "object",
          "properties": {
            "request_date": {
              "type": "string",
              "format": "date-time",
              "description": "When takedown was requested"
            },
            "request_method": {
              "type": "string",
              "enum": ["dmca", "legal_notice", "terms_violation", "court_order"],
              "description": "Method used to request takedown"
            },
            "status": {
              "type": "string",
              "enum": [
                "requested",
                "acknowledged", 
                "in_progress",
                "completed",
                "denied",
                "appealed",
                "reinstated"
              ],
              "description": "Status of takedown request"
            },
            "response_date": {
              "type": "string",
              "format": "date-time",
              "description": "When response to takedown request was received"
            },
            "denial_reason": {
              "type": "string",
              "maxLength": 500,
              "description": "Reason for takedown denial"
            }
          },
          "description": "Details of takedown request and response",
          "additionalProperties": false
        },
        "hosting_service": {
          "type": "string",
          "maxLength": 200,
          "description": "Service hosting the infringing content",
          "examples": [
            "YouTube", "Vimeo", "SoundCloud", "Dropbox",
            "BitTorrent site", "File hosting service"
          ]
        },
        "original_work_url": {
          "type": "string",
          "format": "uri",
          "description": "URL of the original, authorized work",
          "examples": [
            "https://www.netflix.com/title/80025744",
            "https://store.steampowered.com/app/123456/"
          ]
        },
        "fair_use_assessment": {
          "type": "object",
          "properties": {
            "claimed": {
              "type": "boolean",
              "description": "Whether fair use is claimed by the alleged infringer"
            },
            "assessment": {
              "type": "string",
              "enum": ["not_fair_use", "possible_fair_use", "likely_fair_use", "unclear"],
              "description": "Assessment of fair use claim validity"
            },
            "rationale": {
              "type": "string",
              "maxLength": 500,
              "description": "Rationale for fair use assessment"
            }
          },
          "description": "Assessment of fair use claims",
          "additionalProperties": false
        }
      },
      "required": ["work_title", "rights_holder"]
    }
  ],
  "examples": [
    {
      "xarf_version": "4.0.0", 
      "report_id": "copy1234-5678-9abc-def0-123456789abc",
      "timestamp": "2024-01-15T10:30:15Z",
      "reporter": {
        "org": "Content Protection Agency",
        "contact": "dmca@contentprotection.org",
        "type": "automated"
      },
      "source_identifier": "192.0.2.150",
      "class": "copyright",
      "type": "copyright",
      "work_title": "Avengers: Endgame",
      "work_type": "movie",
      "work_identifier": "tt4154796",
      "rights_holder": "Disney Enterprises, Inc.",
      "rights_holder_contact": "legal@disney.com",
      "infringing_url": "http://piracy-site.example.com/movies/avengers-endgame-2019.mp4",
      "torrent_hash": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
      "swarm_size": 1523,
      "seeders": 45,
      "leechers": 1478,
      "evidence_source": "automated_scan",
      "evidence": [
        {
          "content_type": "application/json",
          "description": "Torrent metadata and tracker information",
          "payload": "eyJ0b3JyZW50X2hhc2giOiJhYWY0YzYxZGRjYzVlOGEyZGFiZWRlMGYzYjQ4MmNkOWFlYTk0MzRkIn0="
        }
      ],
      "tags": ["copyright:movie", "p2p:bittorrent", "rights_holder:disney"]
    }
  ]
}