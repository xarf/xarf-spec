{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://xarf.org/schemas/v4/reputation-class.json",
  "title": "XARF v4 Reputation Class Schema",
  "description": "Schema for threat intelligence, reputation-based blocking, and IP/domain reputation information",
  "allOf": [
    {
      "$ref": "xarf-core.json"
    },
    {
      "type": "object",
      "properties": {
        "class": {
          "const": "reputation"
        },
        "type": {
          "type": "string",
          "enum": [
            "blocklist",
            "ip_reclamation",
            "trap",
            "reputation_feed",
            "threat_intelligence",
            "allowlist_removal"
          ],
          "description": "Specific type of reputation-based report"
        },
        "evidence_source": {
          "type": "string",
          "enum": [
            "threat_intelligence",
            "automated_analysis",
            "researcher_analysis",
            "reputation_feed",
            "community_reports",
            "machine_learning",
            "behavioral_analysis"
          ],
          "description": "Source of reputation evidence"
        },
        "threat_type": {
          "type": "string",
          "maxLength": 200,
          "description": "Category of threat or reputation issue (REQUIRED)",
          "examples": [
            "spam_source",
            "malware_c2",
            "phishing_host",
            "botnet_member",
            "open_proxy",
            "compromised_system",
            "scanner",
            "brute_forcer"
          ]
        },
        "reputation_score": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 100.0,
          "description": "Reputation score (0 = completely malicious, 100 = completely trustworthy)"
        },
        "confidence_score": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 100.0,
          "description": "Confidence in the reputation assessment (0-100%)"
        },
        "trust_level": {
          "type": "string",
          "enum": ["very_low", "low", "medium", "high", "very_high"],
          "description": "Categorical trust assessment"
        },
        "first_reported": {
          "type": "string",
          "format": "date-time",
          "description": "When this reputation issue was first reported"
        },
        "last_updated": {
          "type": "string",
          "format": "date-time",
          "description": "When reputation information was last updated"
        },
        "expiration_date": {
          "type": "string",
          "format": "date-time",
          "description": "When this reputation information expires"
        },
        "report_count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of reports contributing to this reputation assessment"
        },
        "reporter_count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of unique reporters contributing to assessment"
        },
        "sources": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 200
          },
          "description": "Information sources contributing to reputation data",
          "examples": [
            ["spamhaus", "malwaredomainlist", "threatfeed_vendor", "community_reports"]
          ],
          "maxItems": 20
        },
        "geographic_location": {
          "type": "object",
          "properties": {
            "country": {
              "type": "string",
              "pattern": "^[A-Z]{2}$",
              "description": "ISO 3166-1 alpha-2 country code"
            },
            "region": {
              "type": "string",
              "maxLength": 100,
              "description": "Geographic region or state"
            },
            "city": {
              "type": "string",
              "maxLength": 100,
              "description": "City location"
            },
            "coordinates": {
              "type": "object",
              "properties": {
                "latitude": {
                  "type": "number",
                  "minimum": -90,
                  "maximum": 90
                },
                "longitude": {
                  "type": "number",
                  "minimum": -180,
                  "maximum": 180
                }
              },
              "required": ["latitude", "longitude"],
              "additionalProperties": false
            }
          },
          "description": "Geographic location information",
          "additionalProperties": false
        },
        "network_information": {
          "type": "object",
          "properties": {
            "asn": {
              "type": "integer",
              "minimum": 1,
              "description": "Autonomous System Number"
            },
            "asn_name": {
              "type": "string",
              "maxLength": 200,
              "description": "AS organization name"
            },
            "isp": {
              "type": "string",
              "maxLength": 200,
              "description": "Internet Service Provider"
            },
            "organization": {
              "type": "string",
              "maxLength": 200,
              "description": "Organization owning the IP space"
            },
            "network_type": {
              "type": "string",
              "enum": [
                "residential",
                "business", 
                "hosting",
                "mobile",
                "government",
                "educational",
                "vpn",
                "proxy",
                "tor"
              ],
              "description": "Type of network or connection"
            }
          },
          "description": "Network and ISP information",
          "additionalProperties": false
        },
        "blocklist_information": {
          "type": "object",
          "properties": {
            "list_name": {
              "type": "string",
              "maxLength": 200,
              "description": "Name of the blocklist or reputation feed"
            },
            "list_category": {
              "type": "string",
              "enum": [
                "spam",
                "malware",
                "phishing",
                "botnet",
                "proxy",
                "scanner",
                "reputation",
                "geo_blocking"
              ],
              "description": "Category of blocklist"
            },
            "listing_reason": {
              "type": "string",
              "maxLength": 500,
              "description": "Reason for blocklist inclusion"
            },
            "listing_date": {
              "type": "string",
              "format": "date-time",
              "description": "When IP/domain was added to blocklist"
            },
            "removal_criteria": {
              "type": "string",
              "maxLength": 500,
              "description": "Criteria for removal from blocklist"
            },
            "auto_removal": {
              "type": "boolean",
              "description": "Whether automatic removal is available"
            },
            "removal_url": {
              "type": "string",
              "format": "uri",
              "description": "URL for requesting removal"
            }
          },
          "description": "Information about blocklist status",
          "additionalProperties": false
        },
        "threat_categories": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "spam",
              "malware",
              "phishing",
              "botnet",
              "c2_server",
              "compromised_host",
              "open_proxy",
              "open_relay",
              "scanner",
              "brute_forcer",
              "ddos_source",
              "fraud",
              "scam",
              "illegal_content"
            ]
          },
          "description": "Categories of threats associated with this entity",
          "uniqueItems": true,
          "maxItems": 10
        },
        "activity_indicators": {
          "type": "object",
          "properties": {
            "spam_activity": {
              "type": "boolean",
              "description": "Recent spam activity detected"
            },
            "malware_activity": {
              "type": "boolean",
              "description": "Recent malware activity detected"
            },
            "scanning_activity": {
              "type": "boolean",
              "description": "Recent scanning activity detected"
            },
            "brute_force_activity": {
              "type": "boolean",
              "description": "Recent brute force activity detected"
            },
            "last_activity": {
              "type": "string",
              "format": "date-time",
              "description": "When malicious activity was last observed"
            },
            "activity_frequency": {
              "type": "string",
              "enum": ["rare", "occasional", "frequent", "constant"],
              "description": "Frequency of malicious activity"
            }
          },
          "description": "Recent activity indicators",
          "additionalProperties": false
        },
        "remediation_info": {
          "type": "object",
          "properties": {
            "recommended_action": {
              "type": "string",
              "enum": [
                "block",
                "quarantine",
                "monitor",
                "investigate",
                "cleanup",
                "notify_customer",
                "legal_action"
              ],
              "description": "Recommended action to take"
            },
            "urgency": {
              "type": "string",
              "enum": ["low", "medium", "high", "critical"],
              "description": "Urgency of required action"
            },
            "remediation_steps": {
              "type": "array",
              "items": {
                "type": "string",
                "maxLength": 200
              },
              "description": "Suggested remediation steps",
              "maxItems": 10
            },
            "contact_info": {
              "type": "string",
              "format": "email",
              "description": "Contact for remediation assistance"
            }
          },
          "description": "Remediation guidance information",
          "additionalProperties": false
        },
        "historical_data": {
          "type": "object",
          "properties": {
            "previous_incidents": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of previous incidents"
            },
            "first_seen_date": {
              "type": "string",
              "format": "date-time",
              "description": "When entity was first seen as malicious"
            },
            "clean_periods": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of periods with no malicious activity"
            },
            "reputation_trend": {
              "type": "string",
              "enum": ["improving", "stable", "degrading", "volatile"],
              "description": "Trend in reputation over time"
            }
          },
          "description": "Historical reputation data",
          "additionalProperties": false
        },
        "domain_information": {
          "type": "object",
          "properties": {
            "domain_age_days": {
              "type": "integer",
              "minimum": 0,
              "description": "Age of domain in days"
            },
            "registrar": {
              "type": "string",
              "maxLength": 200,
              "description": "Domain registrar"
            },
            "registration_date": {
              "type": "string",
              "format": "date-time",
              "description": "Domain registration date"
            },
            "expiration_date": {
              "type": "string",
              "format": "date-time",
              "description": "Domain expiration date"
            },
            "privacy_protection": {
              "type": "boolean",
              "description": "Whether WHOIS privacy protection is enabled"
            },
            "dns_record_count": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of DNS records"
            },
            "subdomain_count": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of known subdomains"
            }
          },
          "description": "Domain-specific reputation information",
          "additionalProperties": false
        }
      },
      "required": ["threat_type"]
    }
  ],
  "examples": [
    {
      "xarf_version": "4.0.0",
      "report_id": "rep12345-6789-abcd-ef01-234567890abc",
      "timestamp": "2024-01-15T12:00:00Z",
      "reporter": {
        "org": "Threat Intelligence Platform",
        "contact": "intel@threatfeed.org",
        "type": "automated"
      },
      "source_identifier": "198.51.100.25",
      "class": "reputation",
      "type": "blocklist",
      "threat_type": "spam_source",
      "reputation_score": 15.0,
      "confidence_score": 92.0,
      "trust_level": "very_low",
      "first_reported": "2024-01-10T08:00:00Z",
      "last_updated": "2024-01-15T11:45:00Z",
      "report_count": 47,
      "reporter_count": 12,
      "sources": ["spamhaus", "barracuda", "community_reports"],
      "evidence_source": "threat_intelligence",
      "blocklist_information": {
        "list_name": "Spam Sources Blocklist",
        "list_category": "spam",
        "listing_reason": "Multiple spam complaints from different networks",
        "listing_date": "2024-01-10T08:00:00Z",
        "auto_removal": true,
        "removal_criteria": "No spam activity for 30 days"
      },
      "evidence": [
        {
          "content_type": "application/json",
          "description": "Reputation intelligence data aggregation",
          "payload": "eyJ0aHJlYXRfdHlwZSI6InNwYW1fc291cmNlIiwicmVwb3J0X2NvdW50Ijo0N30="
        }
      ],
      "tags": ["reputation:spam", "blocklist:active", "confidence:high"]
    }
  ]
}